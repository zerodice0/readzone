# Phase 3: Book System (ë„ì„œ ì‹œìŠ¤í…œ)

## ëª©í‘œ
ì¹´ì¹´ì˜¤ ë„ì„œ API ì—°ë™ê³¼ ìˆ˜ë™ ë„ì„œ ì…ë ¥ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì—¬ ì‚¬ìš©ìê°€ ë‹¤ì–‘í•œ ë„ì„œ ì •ë³´ë¥¼ í™œìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

## ë²”ìœ„

### 1. ì¹´ì¹´ì˜¤ ë„ì„œ API ì—°ë™
- [ ] ì¹´ì¹´ì˜¤ API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
- [ ] API í‚¤ ê´€ë¦¬ ë° ë³´ì•ˆ
- [ ] ê²€ìƒ‰ API ì—°ë™
- [ ] ìƒì„¸ ì •ë³´ API ì—°ë™
- [ ] API ì‚¬ìš©ëŸ‰ ì¶”ì 
- [ ] ìºì‹± ì‹œìŠ¤í…œ êµ¬í˜„

### 2. ë„ì„œ ê²€ìƒ‰ í˜ì´ì§€
- [ ] ê²€ìƒ‰ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- [ ] ì‹¤ì‹œê°„ ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
- [ ] ê²€ìƒ‰ ê²°ê³¼ í•„í„°ë§
- [ ] ê²€ìƒ‰ ê¸°ë¡ ì €ì¥
- [ ] ë¹ˆ ê²€ìƒ‰ ê²°ê³¼ ì²˜ë¦¬

### 3. ìˆ˜ë™ ë„ì„œ ì…ë ¥ ê¸°ëŠ¥
- [ ] ë„ì„œ ì •ë³´ ì…ë ¥ í¼
- [ ] í•„ìˆ˜/ì„ íƒ í•„ë“œ ê²€ì¦
- [ ] ì¥ë¥´ ì„ íƒ UI
- [ ] ì´ë¯¸ì§€ ì—…ë¡œë“œ (ì„ íƒ)
- [ ] ì…ë ¥ ë°ì´í„° ê²€ì¦

### 4. ë„ì„œ ìƒì„¸ í˜ì´ì§€
- [ ] ë„ì„œ ì •ë³´ í‘œì‹œ
- [ ] ê´€ë ¨ ë…í›„ê° ëª©ë¡
- [ ] ë„ì„œ ì˜ê²¬ ì„¹ì…˜
- [ ] êµ¬ë§¤ ë§í¬ í‘œì‹œ
- [ ] ê³µìœ  ê¸°ëŠ¥

### 5. ë„ì„œ ê´€ë¦¬ ì‹œìŠ¤í…œ
- [ ] ë„ì„œ ë°ì´í„° ì €ì¥/ì—…ë°ì´íŠ¸
- [ ] ì¤‘ë³µ ë„ì„œ ì²˜ë¦¬
- [ ] ë„ì„œ ë©”íƒ€ë°ì´í„° ê´€ë¦¬
- [ ] ì¸ê¸° ë„ì„œ íŠ¸ë˜í‚¹

## ê¸°ìˆ  ìš”êµ¬ì‚¬í•­

### ì¹´ì¹´ì˜¤ ë„ì„œ API

#### API í´ë¼ì´ì–¸íŠ¸
```typescript
// lib/kakao.ts
interface KakaoBookSearchParams {
  query: string
  sort?: 'accuracy' | 'latest'
  page?: number
  size?: number
}

interface KakaoBookResponse {
  documents: KakaoBook[]
  meta: {
    total_count: number
    pageable_count: number
    is_end: boolean
  }
}

interface KakaoBook {
  title: string
  contents: string
  url: string
  isbn: string
  datetime: string
  authors: string[]
  publisher: string
  translators: string[]
  price: number
  sale_price: number
  thumbnail: string
  status: string
}

class KakaoBookAPI {
  private apiKey: string
  private baseURL = 'https://dapi.kakao.com/v3/search/book'
  
  constructor(apiKey: string) {
    this.apiKey = apiKey
  }
  
  async search(params: KakaoBookSearchParams): Promise<KakaoBookResponse> {
    // API í˜¸ì¶œ êµ¬í˜„
  }
  
  async getBookByISBN(isbn: string): Promise<KakaoBook | null> {
    // ISBN ê¸°ë°˜ ê²€ìƒ‰
  }
}
```

#### API ì‚¬ìš©ëŸ‰ ê´€ë¦¬
```typescript
interface ApiUsage {
  id: string
  date: string
  searchCount: number
  remaining: number
  resetTime: Date
}

class ApiUsageTracker {
  private usage: Map<string, ApiUsage> = new Map()
  
  track(date: string): void
  canMakeRequest(): boolean
  getRemainingQuota(): number
}
```

### API Routes

#### ë„ì„œ ê²€ìƒ‰
```typescript
// app/api/books/search/route.ts
GET /api/books/search
Query: {
  q: string
  page?: number
  size?: number
  sort?: 'accuracy' | 'latest'
}
Response: {
  books: Book[]
  pagination: {
    page: number
    size: number
    total: number
    hasMore: boolean
  }
}

// app/api/books/manual/route.ts
POST /api/books/manual
Body: {
  title: string
  authors: string[]
  publisher?: string
  genre?: string
  pageCount?: number
  description?: string
}
Response: {
  success: boolean
  book: Book
}
```

#### ë„ì„œ ê´€ë¦¬
```typescript
// app/api/books/[id]/route.ts
GET /api/books/[id]
Response: {
  book: Book
  reviews: BookReview[]
  opinions: BookOpinion[]
  stats: {
    totalReviews: number
    totalOpinions: number
    averageRating: number
    recommendationRate: number
  }
}
```

### ë°ì´í„° ëª¨ë¸ í™•ì¥

```typescript
// types/book.ts
interface Book {
  id: string
  isbn?: string
  title: string
  authors: string[]
  publisher?: string
  genre?: string
  pageCount?: number
  thumbnail?: string
  description?: string
  price?: number
  salePrice?: number
  isManualEntry: boolean
  createdAt: Date
  updatedAt: Date
  
  // ê´€ê³„
  reviews: BookReview[]
  opinions: BookOpinion[]
}

interface BookSearchResult extends Book {
  _count: {
    reviews: number
    opinions: number
  }
  stats: {
    recommendationRate: number
  }
}
```

### ìºì‹± ì „ëµ

```typescript
// lib/cache.ts
interface CacheEntry<T> {
  data: T
  timestamp: number
  expiresAt: number
}

class BookCache {
  private cache = new Map<string, CacheEntry<any>>()
  private readonly TTL = 24 * 60 * 60 * 1000 // 24ì‹œê°„
  
  set<T>(key: string, data: T): void
  get<T>(key: string): T | null
  invalidate(key: string): void
  cleanup(): void
}
```

## UI/UX ëª…ì„¸

### ë„ì„œ ê²€ìƒ‰ í˜ì´ì§€ (/search)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ë„ì„œ ê²€ìƒ‰                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  [ğŸ” ë„ì„œ ì œëª©ì´ë‚˜ ì €ìë¥¼ ì…ë ¥í•˜ì„¸ìš”] â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€ ê²€ìƒ‰ ê²°ê³¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â”‚  [ğŸ“–] ì±… ì œëª©                 â”‚  â”‚
â”‚  â”‚       ì €ìëª… | ì¶œíŒì‚¬         â”‚  â”‚
â”‚  â”‚       â‚©15,000 (â‚©13,500)      â”‚  â”‚
â”‚  â”‚       [ì„ íƒ]                  â”‚  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â”‚  [ğŸ“–] ì±… ì œëª© 2               â”‚  â”‚
â”‚  â”‚       ì €ìëª… | ì¶œíŒì‚¬         â”‚  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  ì°¾ëŠ” ì±…ì´ ì—†ë‚˜ìš”?                   â”‚
â”‚  [â• ì§ì ‘ ì…ë ¥í•˜ê¸°]                  â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìˆ˜ë™ ë„ì„œ ì…ë ¥ í˜ì´ì§€ (/books/manual)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ë„ì„œ ì •ë³´ ì…ë ¥              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ë„ì„œ ì œëª© *                        â”‚
â”‚  [_____________________]            â”‚
â”‚                                     â”‚
â”‚  ì €ì * (ì‰¼í‘œë¡œ êµ¬ë¶„)               â”‚
â”‚  [_____________________]            â”‚
â”‚                                     â”‚
â”‚  ì¶œíŒì‚¬                             â”‚
â”‚  [_____________________]            â”‚
â”‚                                     â”‚
â”‚  ì¥ë¥´                               â”‚
â”‚  [â–¼ ì„ íƒí•˜ì„¸ìš”         ]            â”‚
â”‚                                     â”‚
â”‚  í˜ì´ì§€ ìˆ˜                          â”‚
â”‚  [_____] í˜ì´ì§€                     â”‚
â”‚                                     â”‚
â”‚  ê°„ë‹¨í•œ ì†Œê°œ                        â”‚
â”‚  [________________________]        â”‚
â”‚  [________________________]        â”‚
â”‚  [________________________]        â”‚
â”‚                                     â”‚
â”‚  í‘œì§€ ì´ë¯¸ì§€ (ì„ íƒ)                 â”‚
â”‚  [ğŸ“ íŒŒì¼ ì„ íƒ] ë˜ëŠ” URL            â”‚
â”‚  [_____________________]            â”‚
â”‚                                     â”‚
â”‚  [    ì·¨ì†Œ    ] [    ì €ì¥    ]      â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë„ì„œ ìƒì„¸ í˜ì´ì§€ (/books/[id])
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”  ì±… ì œëª©                    â”‚
â”‚  â”‚ ğŸ“– â”‚  ì €ìëª…                     â”‚
â”‚  â”‚í‘œì§€â”‚  ì¶œíŒì‚¬ | ì¥ë¥´             â”‚
â”‚  â”‚ì´ë¯¸â”‚  â­ 4.2 (ë¦¬ë·° 15ê°œ)        â”‚
â”‚  â”‚ì§€  â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”˜  [ğŸ’ ì¶”ì²œ 85%]              â”‚
â”‚                                     â”‚
â”‚  ğŸ“ ì†Œê°œ                            â”‚
â”‚  ì±…ì— ëŒ€í•œ ê°„ë‹¨í•œ ì†Œê°œ...            â”‚
â”‚                                     â”‚
â”‚  ğŸ›’ êµ¬ë§¤í•˜ê¸°                        â”‚
â”‚  [êµë³´ë¬¸ê³ ] [ì˜ˆìŠ¤24] [ì•Œë¼ë”˜]        â”‚
â”‚                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                     â”‚
â”‚  ğŸ’¬ ì´ ì±…ì— ëŒ€í•œ ì˜ê²¬ (28ê°œ)        â”‚
â”‚                                     â”‚
â”‚  [ì˜ê²¬ì„ ë‚¨ê²¨ë³´ì„¸ìš”...     ] [ğŸ‘ğŸ‘] â”‚
â”‚                                     â”‚
â”‚  @username â€¢ 2ì¼ ì „                 â”‚
â”‚  "ì •ë§ ê°ë™ì ì¸ ì±…ì´ì—ˆì–´ìš”..."       â”‚
â”‚  ğŸ‘ ì¶”ì²œ â€¢ â¤ï¸ 3                     â”‚
â”‚                                     â”‚
â”‚  @username2 â€¢ 1ì£¼ ì „                â”‚
â”‚  "ì¡°ê¸ˆ ì•„ì‰¬ì› ì§€ë§Œ ë‚˜ë¦„ ê´œì°®..."      â”‚
â”‚  ğŸ‘ ë¹„ì¶”ì²œ â€¢ â¤ï¸ 1                   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ì¥ë¥´ ë¶„ë¥˜ ì‹œìŠ¤í…œ

### KDC(í•œêµ­ì‹­ì§„ë¶„ë¥˜ë²•) ê¸°ë°˜ ì¥ë¥´
```typescript
enum BookGenre {
  // ì£¼ìš” ë¶„ë¥˜
  PHILOSOPHY = 'ì² í•™',
  RELIGION = 'ì¢…êµ',
  SOCIAL_SCIENCE = 'ì‚¬íšŒê³¼í•™',
  NATURAL_SCIENCE = 'ìì—°ê³¼í•™',
  TECHNOLOGY = 'ê¸°ìˆ ê³¼í•™',
  ARTS = 'ì˜ˆìˆ ',
  LANGUAGE = 'ì–¸ì–´',
  LITERATURE = 'ë¬¸í•™',
  HISTORY = 'ì—­ì‚¬',
  
  // ì„¸ë¶€ ë¬¸í•™ ì¥ë¥´
  NOVEL = 'ì†Œì„¤',
  POETRY = 'ì‹œ',
  ESSAY = 'ì—ì„¸ì´',
  DRAMA = 'í¬ê³¡',
  
  // ì‹¤ìš©ì„œ
  SELF_HELP = 'ìê¸°ê³„ë°œ',
  BUSINESS = 'ê²½ì˜/ê²½ì œ',
  HEALTH = 'ê±´ê°•',
  COOKING = 'ìš”ë¦¬',
  TRAVEL = 'ì—¬í–‰',
  HOBBY = 'ì·¨ë¯¸',
  
  // ê¸°íƒ€
  CHILDREN = 'ì•„ë™',
  COMICS = 'ë§Œí™”',
  OTHER = 'ê¸°íƒ€'
}
```

### ì¥ë¥´ ë§¤í•‘ ë¡œì§
```typescript
function mapISBNToGenre(isbn: string): BookGenre {
  // ISBN ë¶„ë¥˜ ì½”ë“œ ê¸°ë°˜ ì¥ë¥´ ë§¤í•‘
  const classificationCode = isbn.substring(3, 6)
  // ë¶„ë¥˜ ì½”ë“œì— ë”°ë¥¸ ì¥ë¥´ ë°˜í™˜
}

function extractGenreFromKakao(kakaoBook: KakaoBook): BookGenre {
  // ì¹´ì¹´ì˜¤ API ì‘ë‹µì—ì„œ ì¥ë¥´ ì¶”ì¶œ ë° ë§¤í•‘
}
```

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ì¹´ì¹´ì˜¤ API ì—°ë™ í…ŒìŠ¤íŠ¸
- [ ] ë„ì„œ ê²€ìƒ‰ API í˜¸ì¶œ ì„±ê³µ
- [ ] ISBN ê¸°ë°˜ ìƒì„¸ ì •ë³´ ì¡°íšŒ
- [ ] API ì˜¤ë¥˜ ì²˜ë¦¬ (ë„¤íŠ¸ì›Œí¬, í• ë‹¹ëŸ‰ ì´ˆê³¼)
- [ ] ê²€ìƒ‰ ê²°ê³¼ ìºì‹± ë™ì‘ í™•ì¸

### 2. ë„ì„œ ê²€ìƒ‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] ì œëª©ìœ¼ë¡œ ê²€ìƒ‰
- [ ] ì €ìëª…ìœ¼ë¡œ ê²€ìƒ‰
- [ ] ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ë„¤ì´ì…˜
- [ ] ë¹ˆ ê²€ìƒ‰ ê²°ê³¼ ì²˜ë¦¬
- [ ] ê²€ìƒ‰ ê¸°ë¡ ì €ì¥/í‘œì‹œ

### 3. ìˆ˜ë™ ì…ë ¥ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] í•„ìˆ˜ í•„ë“œ ìœ íš¨ì„± ê²€ì¦
- [ ] ì¤‘ë³µ ë„ì„œ í™•ì¸
- [ ] ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
- [ ] ì¥ë¥´ ì„ íƒ ê¸°ëŠ¥

### 4. ë„ì„œ ìƒì„¸ í˜ì´ì§€ í…ŒìŠ¤íŠ¸
- [ ] ë„ì„œ ì •ë³´ í‘œì‹œ
- [ ] ê´€ë ¨ ë…í›„ê° ëª©ë¡
- [ ] ë„ì„œ ì˜ê²¬ ì‘ì„±/í‘œì‹œ
- [ ] êµ¬ë§¤ ë§í¬ í´ë¦­ ì¶”ì 

## ì™„ë£Œ ê¸°ì¤€

### í•„ìˆ˜ ì™„ë£Œ ì‚¬í•­
1. âœ… **API ì—°ë™**: ì¹´ì¹´ì˜¤ ë„ì„œ ê²€ìƒ‰ API ì™„ì „ ì—°ë™
2. âœ… **ê²€ìƒ‰ ê¸°ëŠ¥**: ì‹¤ì‹œê°„ ê²€ìƒ‰ ë° ê²°ê³¼ í‘œì‹œ
3. âœ… **ìˆ˜ë™ ì…ë ¥**: ê²€ìƒ‰ë˜ì§€ ì•ŠëŠ” ë„ì„œ ì§ì ‘ ë“±ë¡
4. âœ… **ìƒì„¸ í˜ì´ì§€**: ë„ì„œ ì •ë³´ ë° ê´€ë ¨ ì½˜í…ì¸  í‘œì‹œ
5. âœ… **ìºì‹±**: ê²€ìƒ‰ ê²°ê³¼ 24ì‹œê°„ ìºì‹±

### ê²€ì¦ ë°©ë²•
1. ì¸ê¸° ë„ì„œ 10ê¶Œ ê²€ìƒ‰ í›„ ëª¨ë“  ì •ë³´ ì •ìƒ í‘œì‹œ
2. ê²€ìƒ‰ë˜ì§€ ì•ŠëŠ” ë„ì„œ ìˆ˜ë™ ì…ë ¥ ì™„ë£Œ
3. ë„ì„œ ìƒì„¸ í˜ì´ì§€ì—ì„œ ëª¨ë“  ì„¹ì…˜ ì •ìƒ ë™ì‘
4. API ì‚¬ìš©ëŸ‰ ì¶”ì  ë° ìºì‹± í™•ì¸

## ë‹¤ìŒ Phase ì—°ê³„ ì‚¬í•­

Phase 3 ì™„ë£Œ í›„ Phase 4ì—ì„œ í™œìš©í•  ìš”ì†Œ:
- ë„ì„œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë…í›„ê° ì‘ì„±ì— ì—°ë™
- ë„ì„œ ìƒì„¸ í˜ì´ì§€ë¥¼ ë…í›„ê° ìƒì„¸ì—ì„œ ì°¸ì¡°
- ìˆ˜ë™ ì…ë ¥ëœ ë„ì„œ ì •ë³´ í™œìš©
- ì¥ë¥´ ë¶„ë¥˜ë¥¼ ë…í›„ê° í•„í„°ë§ì— í™œìš©

## ìœ„í—˜ ìš”ì†Œ ë° ëŒ€ì‘ ë°©ì•ˆ

### ìœ„í—˜ ìš”ì†Œ
1. **API í• ë‹¹ëŸ‰**: ì¹´ì¹´ì˜¤ API ì¼ì¼ ì‚¬ìš©ëŸ‰ ì œí•œ
2. **ê²€ìƒ‰ ì„±ëŠ¥**: ëŒ€ëŸ‰ ê²€ìƒ‰ ê²°ê³¼ ì²˜ë¦¬ ì‹œ ì§€ì—°
3. **ë°ì´í„° í’ˆì§ˆ**: ìˆ˜ë™ ì…ë ¥ ë°ì´í„°ì˜ ì¼ê´€ì„±

### ëŒ€ì‘ ë°©ì•ˆ
1. **API í• ë‹¹ëŸ‰**: ìºì‹± ê°•í™”, ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§, ëŒ€ì²´ API ê²€í† 
2. **ê²€ìƒ‰ ì„±ëŠ¥**: í˜ì´ì§€ë„¤ì´ì…˜, ë””ë°”ìš´ì‹±, ë¡œë”© ìƒíƒœ í‘œì‹œ
3. **ë°ì´í„° í’ˆì§ˆ**: ì…ë ¥ ê²€ì¦ ê°•í™”, ê´€ë¦¬ì ê²€í†  ì‹œìŠ¤í…œ