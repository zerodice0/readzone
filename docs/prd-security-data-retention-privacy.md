# PRD: S7 - ë°ì´í„° ë³´ì¡´ ë° ê°œì¸ì •ë³´ ë³´í˜¸ ê°•í™”

**ë¬¸ì„œ ë²„ì „**: v1.0  
**ì‘ì„±ì¼**: 2025-02-01  
**ì‘ì„±ì**: ë³´ì•ˆíŒ€  
**ìŠ¹ì¸ì**: DPO (Data Protection Officer)  
**ë³´ì•ˆ ìš°ì„ ìˆœìœ„**: HIGH (8.5/10)

---

## ğŸ“‹ **í”„ë¡œì íŠ¸ ê°œìš”**

### **ëª©í‘œ**
ReadZone Draft ì‹œìŠ¤í…œì˜ ê°œì¸ì •ë³´ ì²˜ë¦¬ ë° ë°ì´í„° ë³´ì¡´ ì •ì±…ì„ GDPR, CCPA ë“± êµ­ì œ ê°œì¸ì •ë³´ë³´í˜¸ ê·œì •ì— ì™„ì „íˆ ì¤€ìˆ˜í•˜ë„ë¡ ê°œì„ í•˜ì—¬ ì‚¬ìš©ìì˜ ê°œì¸ì •ë³´ ìê¸°ê²°ì •ê¶Œì„ ë³´ì¥í•˜ê³  ê·œì œ ë¦¬ìŠ¤í¬ë¥¼ ì œê±°í•œë‹¤.

### **ë°°ê²½**
í˜„ì¬ ì‹œìŠ¤í…œì€ ê¸°ë³¸ì ì¸ ë°ì´í„° ë³´ì¡´ ì •ì±…ë§Œ ìˆì–´ ë‹¤ìŒê³¼ ê°™ì€ ë²•ì /ê·œì œ ìœ„í—˜ì´ ì¡´ì¬í•œë‹¤:
- GDPR Article 17 (ìŠí˜€ì§ˆ ê¶Œë¦¬) ë¯¸ì¤€ìˆ˜
- ê°œì¸ì •ë³´ ë³´ì¡´ ê¸°ê°„ ì •ì±… ë¶€ì¬
- ë°ì´í„° ì‚­ì œ ìš”ì²­ ì²˜ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¡±
- ê°œì¸ì •ë³´ ì²˜ë¦¬ íˆ¬ëª…ì„± ë° ì‚¬ìš©ì ì œì–´ê¶Œ ë¶€ì¡±
- ê°œì¸ì •ë³´ ì´ì „ ë° ì œ3ì ì œê³µì— ëŒ€í•œ ë™ì˜ ê´€ë¦¬ ë¶€ì¬

### **ì„±ê³µ ì§€í‘œ**
- GDPR ì¤€ìˆ˜ìœ¨: 100%
- ë°ì´í„° ì‚­ì œ ìš”ì²­ ì²˜ë¦¬ìœ¨: >99.9%
- ê°œì¸ì •ë³´ ë³´ì¡´ ì •ì±… ì¤€ìˆ˜ìœ¨: 100%
- ê·œì œ ê°ì‚¬ í†µê³¼ìœ¨: 100%
- ì‚¬ìš©ì ê°œì¸ì •ë³´ ì œì–´ ë§Œì¡±ë„: >90%

---

## ğŸ¯ **í•µì‹¬ ìš”êµ¬ì‚¬í•­**

### **FR-1: í¬ê´„ì ì¸ ë°ì´í„° ì‚­ì œ ì‹œìŠ¤í…œ**
- **ìš°ì„ ìˆœìœ„**: Critical
- **ì„¤ëª…**: ì‚¬ìš©ì ìš”ì²­ ì‹œ ì™„ì „í•œ ê°œì¸ì •ë³´ ì‚­ì œ ë³´ì¥
- **ìƒì„¸ ìš”êµ¬ì‚¬í•­**:
  - ì¦‰ì‹œ ì‚­ì œ (ë…¼ë¦¬ì  ì‚­ì œ) 30ì¼ ì´ë‚´
  - ë¬¼ë¦¬ì  ì‚­ì œ (ë°±ì—… ë° ë¡œê·¸ í¬í•¨) 90ì¼ ì´ë‚´
  - ë²•ì  ë³´ì¡´ ì˜ë¬´ ë°ì´í„° ë³„ë„ ê´€ë¦¬
  - ì‚­ì œ í”„ë¡œì„¸ìŠ¤ ê°ì‚¬ ì¶”ì  ì™„ì „ì„±

### **FR-2: ê°œì¸ì •ë³´ ë³´ì¡´ ê¸°ê°„ ê´€ë¦¬**
- **ìš°ì„ ìˆœìœ„**: Critical
- **ì„¤ëª…**: ë°ì´í„° ì¢…ë¥˜ë³„ ì°¨ë“± ë³´ì¡´ ê¸°ê°„ ë° ìë™ ì‚­ì œ
- **ìƒì„¸ ìš”êµ¬ì‚¬í•­**:
  - Draft ë°ì´í„°: 7ì¼ (ê¸°ì¡´ ì •ì±… ìœ ì§€)
  - ê°œì¸ ì‹ë³„ ì •ë³´: íšŒì› íƒˆí‡´ í›„ 5ë…„
  - ì„œë¹„ìŠ¤ ì´ìš© ê¸°ë¡: 1ë…„
  - ë¡œê·¸ ë° ë³´ì•ˆ ë°ì´í„°: 3ë…„
  - ìë™ ë§Œë£Œ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ

### **FR-3: ì‚¬ìš©ì ê°œì¸ì •ë³´ ì œì–´ ì¸í„°í˜ì´ìŠ¤**
- **ìš°ì„ ìˆœìœ„**: High
- **ì„¤ëª…**: ê°œì¸ì •ë³´ ìê¸°ê²°ì •ê¶Œ í–‰ì‚¬ë¥¼ ìœ„í•œ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
- **ìƒì„¸ ìš”êµ¬ì‚¬í•­**:
  - ê°œì¸ì •ë³´ ì²˜ë¦¬ í˜„í™© ëŒ€ì‹œë³´ë“œ
  - ë°ì´í„° ë‹¤ìš´ë¡œë“œ (ì´ë™ê¶Œ) ê¸°ëŠ¥
  - ì²˜ë¦¬ ëª©ì ë³„ ë™ì˜ ê´€ë¦¬
  - ê°œì¸ì •ë³´ ìˆ˜ì •/ì‚­ì œ ìš”ì²­ ì‹œìŠ¤í…œ

### **FR-4: ë™ì˜ ê´€ë¦¬ ì‹œìŠ¤í…œ (CMS)**
- **ìš°ì„ ìˆœìœ„**: High
- **ì„¤ëª…**: ì„¸ë¶„í™”ëœ ê°œì¸ì •ë³´ ì²˜ë¦¬ ë™ì˜ ê´€ë¦¬
- **ìƒì„¸ ìš”êµ¬ì‚¬í•­**:
  - ì²˜ë¦¬ ëª©ì ë³„ ì„¸ë¶„í™”ëœ ë™ì˜
  - ë™ì˜ ì² íšŒ ì¦‰ì‹œ ë°˜ì˜
  - ë™ì˜ ì´ë ¥ ì¶”ì  ë° ê°ì‚¬
  - ë§ˆì¼€íŒ…/ë¶„ì„ ë™ì˜ ë³„ë„ ê´€ë¦¬

### **FR-5: ê°œì¸ì •ë³´ ì˜í–¥í‰ê°€ (PIA) ì‹œìŠ¤í…œ**
- **ìš°ì„ ìˆœìœ„**: Medium
- **ì„¤ëª…**: ìƒˆë¡œìš´ ê°œì¸ì •ë³´ ì²˜ë¦¬ì— ëŒ€í•œ ì˜í–¥í‰ê°€ ìë™í™”
- **ìƒì„¸ ìš”êµ¬ì‚¬í•­**:
  - ê°œì¸ì •ë³´ ì²˜ë¦¬ ìœ„í—˜ë„ ìë™ í‰ê°€
  - ê³ ìœ„í—˜ ì²˜ë¦¬ì— ëŒ€í•œ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤
  - ì •ê¸°ì  ê°œì¸ì •ë³´ ì²˜ë¦¬ í˜„í™© ëª¨ë‹ˆí„°ë§
  - ê·œì œ ë³€ê²½ì‚¬í•­ ìë™ ë°˜ì˜

---

## ğŸ›¡ï¸ **ê°œì¸ì •ë³´ë³´í˜¸ ì•„í‚¤í…ì²˜**

### **ë°ì´í„° ë¶„ë¥˜ ë° ë³´ì¡´ ì •ì±…**
```typescript
interface DataClassification {
  // ê°œì¸ì‹ë³„ì •ë³´ (PII)
  personallyIdentifiableInfo: {
    category: 'PII',
    examples: ['email', 'name', 'phone', 'address'],
    retentionPeriod: '5_years_after_withdrawal',
    legalBasis: 'contract_performance',
    deletionPriority: 'critical'
  }
  
  // ë¯¼ê°ì •ë³´
  sensitivePersonalInfo: {
    category: 'SPI', 
    examples: ['reading_preferences', 'personal_opinions', 'political_views'],
    retentionPeriod: '1_year_after_last_activity',
    legalBasis: 'consent',
    deletionPriority: 'critical'
  }
  
  // ì„œë¹„ìŠ¤ ì´ìš© ê¸°ë¡
  serviceUsageData: {
    category: 'Usage',
    examples: ['login_history', 'page_views', 'feature_usage'],
    retentionPeriod: '1_year',
    legalBasis: 'legitimate_interest',
    deletionPriority: 'high'
  }
  
  // ë³´ì•ˆ ë° ê°ì‚¬ ë¡œê·¸
  securityAuditLogs: {
    category: 'Security',
    examples: ['security_events', 'access_logs', 'error_logs'],
    retentionPeriod: '3_years',
    legalBasis: 'legal_obligation',
    deletionPriority: 'medium'
  }
  
  // ìµëª…í™”ëœ ë¶„ì„ ë°ì´í„°
  anonymizedAnalytics: {
    category: 'Anonymous',
    examples: ['aggregated_statistics', 'anonymized_usage_patterns'],
    retentionPeriod: 'unlimited',
    legalBasis: 'not_applicable',
    deletionPriority: 'low'
  }
}
```

### **ë™ì˜ ê´€ë¦¬ êµ¬ì¡°**
```typescript
interface ConsentManagement {
  consentTypes: {
    essential: {
      required: true,
      withdrawable: false,
      description: 'ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•œ í•„ìˆ˜ ì²˜ë¦¬',
      purposes: ['account_management', 'service_delivery', 'security']
    },
    functional: {
      required: false,
      withdrawable: true,
      description: 'ì„œë¹„ìŠ¤ ê¸°ëŠ¥ í–¥ìƒì„ ìœ„í•œ ì²˜ë¦¬',
      purposes: ['personalization', 'preference_storage', 'user_experience']
    },
    analytics: {
      required: false,
      withdrawable: true,
      description: 'ì„œë¹„ìŠ¤ ë¶„ì„ ë° ê°œì„ ì„ ìœ„í•œ ì²˜ë¦¬',
      purposes: ['usage_analytics', 'performance_monitoring', 'service_improvement']
    },
    marketing: {
      required: false,
      withdrawable: true,
      description: 'ë§ˆì¼€íŒ… ë° ê´‘ê³ ë¥¼ ìœ„í•œ ì²˜ë¦¬',
      purposes: ['email_marketing', 'targeted_advertising', 'promotional_content']
    }
  },
  
  consentGranularity: {
    purpose_level: 'specific_processing_purpose',
    data_type_level: 'personal_data_category',
    retention_level: 'retention_period_control',
    sharing_level: 'third_party_sharing_control'
  }
}
```

---

## ğŸ—„ï¸ **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ í™•ì¥**

### **ê°œì¸ì •ë³´ ê´€ë¦¬ í…Œì´ë¸”**
```sql
-- ì‚¬ìš©ì ê°œì¸ì •ë³´ ì²˜ë¦¬ ë™ì˜
CREATE TABLE user_privacy_consent (
    id TEXT PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id TEXT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    
    -- ë™ì˜ ì •ë³´
    consent_type TEXT NOT NULL CHECK (consent_type IN ('essential', 'functional', 'analytics', 'marketing')),
    processing_purpose TEXT NOT NULL,
    data_categories JSONB NOT NULL, -- ì²˜ë¦¬í•˜ëŠ” ê°œì¸ì •ë³´ ìœ í˜•
    
    -- ë™ì˜ ìƒíƒœ
    consent_given BOOLEAN NOT NULL,
    consent_timestamp TIMESTAMPTZ NOT NULL,
    consent_method TEXT NOT NULL, -- web_form, api, import
    consent_version TEXT NOT NULL, -- ë™ì˜ì„œ ë²„ì „
    
    -- ì² íšŒ ì •ë³´
    withdrawal_timestamp TIMESTAMPTZ,
    withdrawal_method TEXT,
    withdrawal_reason TEXT,
    
    -- ë©”íƒ€ë°ì´í„°
    ip_address INET,
    user_agent TEXT,
    legal_basis TEXT NOT NULL, -- consent, contract, legitimate_interest, legal_obligation
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_privacy_consent_user_id (user_id),
    INDEX idx_privacy_consent_type (consent_type),
    INDEX idx_privacy_consent_status (consent_given),
    INDEX idx_privacy_consent_timestamp (consent_timestamp)
);

-- ë°ì´í„° ë³´ì¡´ ì •ì±…
CREATE TABLE data_retention_policy (
    id TEXT PRIMARY KEY DEFAULT gen_random_uuid(),
    data_category TEXT NOT NULL,
    data_type TEXT NOT NULL,
    
    -- ë³´ì¡´ ì •ì±…
    retention_period_days INT NOT NULL,
    retention_basis TEXT NOT NULL, -- legal_requirement, business_need, user_consent
    auto_deletion BOOLEAN DEFAULT true,
    
    -- ì‚­ì œ ì •ì±…
    soft_delete_days INT DEFAULT 30, -- ë…¼ë¦¬ì  ì‚­ì œ ê¸°ê°„
    hard_delete_days INT DEFAULT 90, -- ë¬¼ë¦¬ì  ì‚­ì œ ê¸°ê°„
    
    -- ì˜ˆì™¸ ì‚¬í•­
    legal_hold_exceptions JSONB, -- ë²•ì  ë³´ì¡´ ì˜ë¬´ ì˜ˆì™¸
    business_exceptions JSONB, -- ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸
    
    -- ë©”íƒ€ë°ì´í„°
    policy_version TEXT NOT NULL,
    effective_from TIMESTAMPTZ DEFAULT NOW(),
    effective_until TIMESTAMPTZ,
    created_by TEXT REFERENCES users(id),
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    UNIQUE(data_category, data_type, policy_version)
);

-- ë°ì´í„° ì‚­ì œ ìš”ì²­ ë° ì²˜ë¦¬
CREATE TABLE data_deletion_request (
    id TEXT PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id TEXT NOT NULL REFERENCES users(id),
    
    -- ìš”ì²­ ì •ë³´
    request_type TEXT NOT NULL CHECK (request_type IN ('partial_deletion', 'full_deletion', 'account_closure')),
    requested_data_types JSONB, -- ì‚­ì œ ìš”ì²­í•œ ë°ì´í„° ìœ í˜•
    deletion_reason TEXT,
    
    -- ì²˜ë¦¬ ìƒíƒœ
    status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'processing', 'completed', 'rejected', 'cancelled')),
    processing_started_at TIMESTAMPTZ,
    processing_completed_at TIMESTAMPTZ,
    
    -- ì‚­ì œ ê²°ê³¼
    deleted_records_count JSONB, -- ë°ì´í„° ìœ í˜•ë³„ ì‚­ì œëœ ë ˆì½”ë“œ ìˆ˜
    deletion_report JSONB, -- ìƒì„¸ ì‚­ì œ ë³´ê³ ì„œ
    retention_exceptions JSONB, -- ë²•ì  ë³´ì¡´ ì˜ë¬´ë¡œ ì¸í•œ ì˜ˆì™¸ì‚¬í•­
    
    -- ê²€ì¦ ì •ë³´
    verification_required BOOLEAN DEFAULT false,
    verification_completed_at TIMESTAMPTZ,
    verification_method TEXT, -- email_verification, identity_verification
    
    -- ê°ì‚¬ ì •ë³´
    processed_by TEXT REFERENCES users(id),
    ip_address INET,
    user_agent TEXT,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_deletion_request_user_id (user_id),
    INDEX idx_deletion_request_status (status),
    INDEX idx_deletion_request_type (request_type),
    INDEX idx_deletion_request_created (created_at)
);

-- ë°ì´í„° ì ‘ê·¼ ë° ë‹¤ìš´ë¡œë“œ ë¡œê·¸
CREATE TABLE data_access_log (
    id TEXT PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id TEXT NOT NULL REFERENCES users(id),
    
    -- ì ‘ê·¼ ì •ë³´
    access_type TEXT NOT NULL CHECK (access_type IN ('view', 'download', 'export', 'modify', 'delete')),
    data_category TEXT NOT NULL,
    data_fields JSONB, -- ì ‘ê·¼í•œ êµ¬ì²´ì  í•„ë“œë“¤
    
    -- ìš”ì²­ ì •ë³´
    purpose TEXT, -- data_portability, privacy_dashboard, user_request
    request_size_bytes BIGINT,
    response_size_bytes BIGINT,
    
    -- ê²°ê³¼
    access_granted BOOLEAN NOT NULL,
    denial_reason TEXT,
    
    -- ë©”íƒ€ë°ì´í„°
    ip_address INET NOT NULL,
    user_agent TEXT,
    session_id TEXT,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_data_access_user_id (user_id),
    INDEX idx_data_access_type (access_type),
    INDEX idx_data_access_granted (access_granted),
    INDEX idx_data_access_time (created_at)
);

-- ê°œì¸ì •ë³´ ì˜í–¥í‰ê°€ (PIA)
CREATE TABLE privacy_impact_assessment (
    id TEXT PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- í‰ê°€ ëŒ€ìƒ
    assessment_name TEXT NOT NULL,
    processing_activity TEXT NOT NULL,
    data_categories JSONB NOT NULL,
    processing_purposes JSONB NOT NULL,
    
    -- ìœ„í—˜ í‰ê°€
    risk_level TEXT NOT NULL CHECK (risk_level IN ('low', 'medium', 'high', 'very_high')),
    risk_factors JSONB, -- ì‹ë³„ëœ ìœ„í—˜ ìš”ì†Œë“¤
    likelihood_score INT CHECK (likelihood_score >= 1 AND likelihood_score <= 5),
    impact_score INT CHECK (impact_score >= 1 AND impact_score <= 5),
    
    -- ì™„í™” ì¡°ì¹˜
    mitigation_measures JSONB,
    residual_risk_level TEXT CHECK (residual_risk_level IN ('low', 'medium', 'high', 'very_high')),
    
    -- ìŠ¹ì¸ ë° ê²€í† 
    approval_required BOOLEAN DEFAULT false,
    approved_by TEXT REFERENCES users(id),
    approved_at TIMESTAMPTZ,
    
    next_review_date DATE,
    review_frequency_months INT DEFAULT 12,
    
    -- ë©”íƒ€ë°ì´í„°
    assessed_by TEXT NOT NULL REFERENCES users(id),
    assessment_date DATE NOT NULL,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    INDEX idx_pia_risk_level (risk_level),
    INDEX idx_pia_approval (approval_required, approved_at),
    INDEX idx_pia_review_date (next_review_date)
);
```

---

## ğŸ”— **API ì„¤ê³„ í™•ì¥**

### **ê°œì¸ì •ë³´ ê´€ë¦¬ API**

#### **GET /api/privacy/data-overview**
- **ê¸°ëŠ¥**: ì‚¬ìš©ì ê°œì¸ì •ë³´ ì²˜ë¦¬ í˜„í™© ì¡°íšŒ
- **ì‘ë‹µ**:
```json
{
  "success": true,
  "data": {
    "personalData": {
      "categories": ["account_info", "usage_data", "preferences"],
      "processingPurposes": ["service_delivery", "personalization", "analytics"],
      "dataRetention": {
        "account_info": "5_years_after_withdrawal",
        "usage_data": "1_year",
        "preferences": "until_withdrawal"
      }
    },
    "consentStatus": {
      "essential": { "given": true, "withdrawable": false },
      "functional": { "given": true, "withdrawable": true },
      "analytics": { "given": false, "withdrawable": true },
      "marketing": { "given": false, "withdrawable": true }
    },
    "dataSize": {
      "totalRecords": 1247,
      "estimatedSize": "2.4MB"
    }
  }
}
```

#### **POST /api/privacy/data-export**
- **ê¸°ëŠ¥**: ê°œì¸ì •ë³´ ì´ë™ê¶Œ (ë°ì´í„° ë‹¤ìš´ë¡œë“œ)
- **ìš”ì²­**:
```json
{
  "exportFormat": "json",
  "dataCategories": ["account_info", "drafts", "reviews"],
  "includeMetadata": true
}
```

#### **POST /api/privacy/deletion-request**
- **ê¸°ëŠ¥**: ê°œì¸ì •ë³´ ì‚­ì œ ìš”ì²­
- **ìš”ì²­**:
```json
{
  "deletionType": "partial_deletion",
  "dataCategories": ["usage_data", "analytics_data"],
  "reason": "privacy_concern",
  "verificationMethod": "email_verification"
}
```

#### **PUT /api/privacy/consent**
- **ê¸°ëŠ¥**: ê°œì¸ì •ë³´ ì²˜ë¦¬ ë™ì˜ ê´€ë¦¬
- **ìš”ì²­**:
```json
{
  "consentType": "analytics",
  "consentGiven": false,
  "withdrawalReason": "privacy_preference"
}
```

### **ê°œì¸ì •ë³´ ê´€ë¦¬ ì„œë¹„ìŠ¤**
```typescript
export class PrivacyManagementService {
  // ë°ì´í„° ì‚­ì œ ìš”ì²­ ì²˜ë¦¬
  async processDataDeletionRequest(userId: string, request: DeletionRequest): Promise<DeletionResult> {
    const deletionId = generateId()
    
    try {
      // 1ë‹¨ê³„: ì‚­ì œ ìš”ì²­ ê²€ì¦
      await this.validateDeletionRequest(userId, request)
      
      // 2ë‹¨ê³„: ë²•ì  ë³´ì¡´ ì˜ë¬´ í™•ì¸
      const retentionExceptions = await this.checkLegalRetentionRequirements(userId, request.dataCategories)
      
      // 3ë‹¨ê³„: ì‚­ì œ ìš”ì²­ ê¸°ë¡
      const deletionRecord = await db.dataDeletionRequest.create({
        data: {
          id: deletionId,
          userId,
          requestType: request.deletionType,
          requestedDataTypes: request.dataCategories,
          deletionReason: request.reason,
          retentionExceptions,
          status: 'processing'
        }
      })
      
      // 4ë‹¨ê³„: ë¹„ë™ê¸° ì‚­ì œ í”„ë¡œì„¸ìŠ¤ ì‹œì‘
      await this.queueDeletionProcess(deletionId)
      
      return {
        deletionId,
        estimatedCompletionDate: this.calculateCompletionDate(),
        retentionExceptions,
        status: 'processing'
      }
      
    } catch (error) {
      await this.logDeletionError(userId, request, error)
      throw error
    }
  }
  
  // ì‹¤ì œ ë°ì´í„° ì‚­ì œ ì‹¤í–‰
  async executeDeletion(deletionId: string): Promise<void> {
    const deletionRequest = await db.dataDeletionRequest.findUnique({
      where: { id: deletionId }
    })
    
    if (!deletionRequest) {
      throw new Error('Deletion request not found')
    }
    
    const deletionResult = {
      deletedRecords: {} as Record<string, number>,
      errors: [] as string[]
    }
    
    try {
      // ë³‘ë ¬ ì‚­ì œ ì‹¤í–‰
      const deletionTasks = deletionRequest.requestedDataTypes.map(async (dataType: string) => {
        try {
          const count = await this.deleteDataByType(deletionRequest.userId, dataType)
          deletionResult.deletedRecords[dataType] = count
        } catch (error) {
          deletionResult.errors.push(`${dataType}: ${error.message}`)
        }
      })
      
      await Promise.all(deletionTasks)
      
      // ì‚­ì œ ì™„ë£Œ ê¸°ë¡
      await db.dataDeletionRequest.update({
        where: { id: deletionId },
        data: {
          status: deletionResult.errors.length > 0 ? 'partially_completed' : 'completed',
          processingCompletedAt: new Date(),
          deletedRecordsCount: deletionResult.deletedRecords,
          deletionReport: { errors: deletionResult.errors }
        }
      })
      
      // ì‚¬ìš©ì ì•Œë¦¼
      await this.notifyDeletionCompletion(deletionRequest.userId, deletionResult)
      
    } catch (error) {
      await db.dataDeletionRequest.update({
        where: { id: deletionId },
        data: {
          status: 'failed',
          deletionReport: { error: error.message }
        }
      })
      throw error
    }
  }
  
  // ë°ì´í„° ìœ í˜•ë³„ ì‚­ì œ
  private async deleteDataByType(userId: string, dataType: string): Promise<number> {
    switch (dataType) {
      case 'drafts':
        return await this.deleteDrafts(userId)
      case 'reviews':
        return await this.deleteReviews(userId)
      case 'usage_data':
        return await this.deleteUsageData(userId)
      case 'preferences':
        return await this.deletePreferences(userId)
      default:
        throw new Error(`Unknown data type: ${dataType}`)
    }
  }
  
  private async deleteDrafts(userId: string): Promise<number> {
    // ë…¼ë¦¬ì  ì‚­ì œ (30ì¼ í›„ ë¬¼ë¦¬ì  ì‚­ì œ)
    const result = await db.reviewDraft.updateMany({
      where: { userId },
      data: {
        status: 'DELETED',
        deletedAt: new Date(),
        scheduledDeletionAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30ì¼ í›„
      }
    })
    
    return result.count
  }
  
  // ë™ì˜ ê´€ë¦¬
  async updateConsent(userId: string, consentUpdate: ConsentUpdate): Promise<void> {
    const consent = await db.userPrivacyConsent.upsert({
      where: {
        userId_consentType: {
          userId,
          consentType: consentUpdate.consentType
        }
      },
      create: {
        userId,
        consentType: consentUpdate.consentType,
        processingPurpose: this.getProcessingPurpose(consentUpdate.consentType),
        dataCategories: this.getDataCategories(consentUpdate.consentType),
        consentGiven: consentUpdate.consentGiven,
        consentTimestamp: new Date(),
        consentMethod: 'web_form',
        consentVersion: 'v1.0',
        legalBasis: 'consent'
      },
      update: {
        consentGiven: consentUpdate.consentGiven,
        withdrawalTimestamp: consentUpdate.consentGiven ? null : new Date(),
        withdrawalMethod: consentUpdate.consentGiven ? null : 'web_form',
        withdrawalReason: consentUpdate.withdrawalReason
      }
    })
    
    // ë™ì˜ ì² íšŒ ì‹œ ê´€ë ¨ ë°ì´í„° ì²˜ë¦¬ ì¤‘ë‹¨
    if (!consentUpdate.consentGiven) {
      await this.stopDataProcessingForPurpose(userId, consentUpdate.consentType)
    }
  }
  
  // ë°ì´í„° ì´ë™ê¶Œ (í¬í„°ë¹Œë¦¬í‹°)
  async exportUserData(userId: string, exportRequest: DataExportRequest): Promise<DataExportResult> {
    const exportId = generateId()
    
    try {
      // ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì§‘
      const userData = await this.collectUserData(userId, exportRequest.dataCategories)
      
      // ë°ì´í„° í¬ë§·íŒ…
      const formattedData = this.formatExportData(userData, exportRequest.exportFormat)
      
      // ë³´ì•ˆ íŒŒì¼ ìƒì„± (ì•”í˜¸í™”)
      const exportFile = await this.createSecureExportFile(formattedData, exportId)
      
      // ì ‘ê·¼ ë¡œê·¸ ê¸°ë¡
      await this.logDataAccess(userId, 'export', exportRequest.dataCategories)
      
      return {
        exportId,
        downloadUrl: `/api/privacy/download/${exportId}`,
        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24ì‹œê°„ í›„ ë§Œë£Œ
        fileSize: exportFile.size,
        recordCount: userData.totalRecords
      }
      
    } catch (error) {
      await this.logExportError(userId, exportRequest, error)
      throw error
    }
  }
}

interface DeletionRequest {
  deletionType: 'partial_deletion' | 'full_deletion' | 'account_closure'
  dataCategories: string[]
  reason?: string
  verificationMethod: 'email_verification' | 'identity_verification'
}

interface ConsentUpdate {
  consentType: 'essential' | 'functional' | 'analytics' | 'marketing'
  consentGiven: boolean
  withdrawalReason?: string
}

interface DataExportRequest {
  exportFormat: 'json' | 'csv' | 'xml'
  dataCategories: string[]
  includeMetadata: boolean
}
```

---

## ğŸ§ª **ê°œì¸ì •ë³´ë³´í˜¸ í…ŒìŠ¤íŠ¸ ì „ëµ**

### **GDPR ì¤€ìˆ˜ í…ŒìŠ¤íŠ¸**
```typescript
describe('GDPR Compliance Tests', () => {
  describe('Right to Erasure (Article 17)', () => {
    it('should completely delete user data upon request', async () => {
      const user = await createTestUser()
      const draft = await createDraft(user.id)
      
      // ì‚­ì œ ìš”ì²­
      const deletionResponse = await request(app)
        .post('/api/privacy/deletion-request')
        .set('Authorization', `Bearer ${user.token}`)
        .send({
          deletionType: 'full_deletion',
          dataCategories: ['all'],
          verificationMethod: 'email_verification'
        })
      
      expect(deletionResponse.status).toBe(202)
      
      // ì‚­ì œ í”„ë¡œì„¸ìŠ¤ ì™„ë£Œ ëŒ€ê¸°
      await waitForDeletionCompletion(deletionResponse.body.data.deletionId)
      
      // ë°ì´í„° ì‚­ì œ í™•ì¸
      const deletedDraft = await db.reviewDraft.findUnique({
        where: { id: draft.id }
      })
      expect(deletedDraft?.status).toBe('DELETED')
    })
    
    it('should respect legal retention requirements', async () => {
      // ë²•ì  ë³´ì¡´ ì˜ë¬´ê°€ ìˆëŠ” ë°ì´í„° í…ŒìŠ¤íŠ¸
    })
  })
  
  describe('Right to Data Portability (Article 20)', () => {
    it('should export user data in machine-readable format', async () => {
      const user = await createTestUser()
      
      const exportResponse = await request(app)
        .post('/api/privacy/data-export')
        .set('Authorization', `Bearer ${user.token}`)
        .send({
          exportFormat: 'json',
          dataCategories: ['account_info', 'drafts'],
          includeMetadata: true
        })
      
      expect(exportResponse.status).toBe(202)
      expect(exportResponse.body.data.downloadUrl).toBeDefined()
    })
  })
  
  describe('Consent Management', () => {
    it('should allow granular consent control', async () => {
      const user = await createTestUser()
      
      // ë¶„ì„ ë™ì˜ ì² íšŒ
      const consentResponse = await request(app)
        .put('/api/privacy/consent')
        .set('Authorization', `Bearer ${user.token}`)
        .send({
          consentType: 'analytics',
          consentGiven: false,
          withdrawalReason: 'privacy_preference'
        })
      
      expect(consentResponse.status).toBe(200)
      
      // ë™ì˜ ìƒíƒœ í™•ì¸
      const consent = await db.userPrivacyConsent.findFirst({
        where: { userId: user.id, consentType: 'analytics' }
      })
      expect(consent?.consentGiven).toBe(false)
      expect(consent?.withdrawalTimestamp).toBeDefined()
    })
  })
})
```

---

## ğŸš€ **SuperClaude ëª…ë ¹ì–´ ê°€ì´ë“œ**

### **Phase 1: ë°ì´í„° ì‚­ì œ ì‹œìŠ¤í…œ êµ¬ì¶•**

#### **í¬ê´„ì ì¸ ë°ì´í„° ì‚­ì œ ì‹œìŠ¤í…œ**
```bash
/sc:implement data-deletion-system --persona security --c7 @docs/prd-security-data-retention-privacy.md
/sc:design deletion-architecture --persona security --seq @docs/prd-security-data-retention-privacy.md
/sc:test data-deletion-completeness --persona security --play @docs/prd-security-data-retention-privacy.md
```

#### **ìë™ ë°ì´í„° ë³´ì¡´ ê´€ë¦¬**
```bash
/sc:implement retention-policy-engine --persona backend --c7 @docs/prd-security-data-retention-privacy.md
/sc:design automated-deletion --persona backend --seq @docs/prd-security-data-retention-privacy.md
/sc:analyze retention-compliance --focus security --persona security @docs/prd-security-data-retention-privacy.md
```

### **Phase 2: ë™ì˜ ê´€ë¦¬ ì‹œìŠ¤í…œ (CMS)**

#### **ì„¸ë¶„í™”ëœ ë™ì˜ ê´€ë¦¬**
```bash
/sc:implement consent-management-system --persona security --c7 @docs/prd-security-data-retention-privacy.md
/sc:design consent-ui --persona frontend --magic @docs/prd-security-data-retention-privacy.md
/sc:test consent-granularity --persona qa --play @docs/prd-security-data-retention-privacy.md
```

#### **ë™ì˜ ì´ë ¥ ì¶”ì **
```bash
/sc:implement consent-audit-trail --persona backend --c7 @docs/prd-security-data-retention-privacy.md
/sc:design consent-reporting --persona backend --seq @docs/prd-security-data-retention-privacy.md
/sc:analyze consent-compliance --focus security --persona security @docs/prd-security-data-retention-privacy.md
```

### **Phase 3: ê°œì¸ì •ë³´ ì œì–´ ì¸í„°í˜ì´ìŠ¤**

#### **ê°œì¸ì •ë³´ ëŒ€ì‹œë³´ë“œ**
```bash
/sc:implement privacy-dashboard --persona frontend --magic @docs/prd-security-data-retention-privacy.md
/sc:design data-overview-ui --persona frontend --magic @docs/prd-security-data-retention-privacy.md
/sc:test privacy-dashboard-usability --persona qa --play @docs/prd-security-data-retention-privacy.md
```

#### **ë°ì´í„° ì´ë™ê¶Œ (í¬í„°ë¹Œë¦¬í‹°)**
```bash
/sc:implement data-export-system --persona backend --c7 @docs/prd-security-data-retention-privacy.md
/sc:design secure-data-export --persona security --seq @docs/prd-security-data-retention-privacy.md
/sc:test data-export-completeness --persona security --play @docs/prd-security-data-retention-privacy.md
```

### **Phase 4: ê°œì¸ì •ë³´ ì˜í–¥í‰ê°€ ì‹œìŠ¤í…œ**

#### **ìë™ PIA ì‹œìŠ¤í…œ**
```bash
/sc:implement privacy-impact-assessment --persona security --seq @docs/prd-security-data-retention-privacy.md
/sc:design risk-assessment-engine --persona security --c7 @docs/prd-security-data-retention-privacy.md
/sc:test pia-accuracy --persona security --play @docs/prd-security-data-retention-privacy.md
```

#### **ê·œì œ ì¤€ìˆ˜ ëª¨ë‹ˆí„°ë§**
```bash
/sc:implement compliance-monitoring --persona devops --c7 @docs/prd-security-data-retention-privacy.md
/sc:design compliance-dashboard --persona devops --magic @docs/prd-security-data-retention-privacy.md
/sc:analyze compliance-gaps --focus security --persona security @docs/prd-security-data-retention-privacy.md
```

### **Phase 5: GDPR/CCPA ì¤€ìˆ˜ ê²€ì¦**

#### **ê·œì œ ì¤€ìˆ˜ í…ŒìŠ¤íŠ¸**
```bash
/sc:test gdpr-compliance --persona security --play @docs/prd-security-data-retention-privacy.md
/sc:test ccpa-compliance --persona security --play @docs/prd-security-data-retention-privacy.md
/sc:analyze privacy-law-compliance --focus security --depth deep --persona security @docs/prd-security-data-retention-privacy.md
```

#### **ê°ì‚¬ ì¤€ë¹„ ë° ë¬¸ì„œí™”**
```bash
/sc:document privacy-procedures --persona scribe=en @docs/prd-security-data-retention-privacy.md
/sc:implement audit-reporting --persona devops --c7 @docs/prd-security-data-retention-privacy.md
/sc:test audit-readiness --persona qa --play @docs/prd-security-data-retention-privacy.md
```

### **ì „ì²´ í”„ë¡œì íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜**

#### **ê°œì¸ì •ë³´ë³´í˜¸ ì•„í‚¤í…ì²˜ ì„¤ê³„**
```bash
/sc:workflow @docs/prd-security-data-retention-privacy.md --strategy systematic --persona security --all-mcp --output detailed
/sc:design privacy-architecture --persona architect --seq @docs/prd-security-data-retention-privacy.md
```

#### **ê°œì¸ì •ë³´ë³´í˜¸ êµ¬í˜„ ê²€ì¦**
```bash
/sc:analyze privacy-implementation --focus security --depth deep --persona security @docs/prd-security-data-retention-privacy.md
/sc:test privacy-integration --persona qa --play @docs/prd-security-data-retention-privacy.md
/sc:improve privacy-optimization --type security --persona security @docs/prd-security-data-retention-privacy.md
```

---

## ğŸ“Š **ê·œì œ ì¤€ìˆ˜ ì§€í‘œ**

### **GDPR ì¤€ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸**
- âœ… ê°œì¸ì •ë³´ ì²˜ë¦¬ ì ë²•ì„± í™•ë³´ (Article 6)
- âœ… ì •ë³´ì£¼ì²´ ê¶Œë¦¬ ë³´ì¥ (Articles 15-22)
- âœ… ê°œì¸ì •ë³´ ë³´í˜¸ by Design/Default (Article 25)
- âœ… ê°œì¸ì •ë³´ ì˜í–¥í‰ê°€ ì‹¤ì‹œ (Article 35)
- âœ… ê°œì¸ì •ë³´ ë³´í˜¸ì±…ì„ì ì§€ì • (Article 37)

### **CCPA ì¤€ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸**
- âœ… ê°œì¸ì •ë³´ ìˆ˜ì§‘ ê³ ì§€ (Section 1798.100)
- âœ… ê°œì¸ì •ë³´ ì‚­ì œê¶Œ ë³´ì¥ (Section 1798.105)
- âœ… ê°œì¸ì •ë³´ íŒë§¤ ê¸ˆì§€ ìš”êµ¬ê¶Œ (Section 1798.120)
- âœ… ê°œì¸ì •ë³´ ì´ë™ê¶Œ ë³´ì¥ (Section 1798.110)

### **ì •ëŸ‰ì  ì§€í‘œ**
- ë°ì´í„° ì‚­ì œ ìš”ì²­ ì²˜ë¦¬ìœ¨: >99.9%
- ê°œì¸ì •ë³´ ì´ë™ê¶Œ ìš”ì²­ ì²˜ë¦¬ ì‹œê°„: <7ì¼
- ë™ì˜ ì² íšŒ ë°˜ì˜ ì‹œê°„: <24ì‹œê°„
- ê·œì œ ê°ì‚¬ í†µê³¼ìœ¨: 100%

---

**ë¬¸ì„œ ìŠ¹ì¸ ìƒíƒœ**: â³ ê²€í†  ì¤‘  
**êµ¬í˜„ ìš°ì„ ìˆœìœ„**: HIGH  
**ì˜ˆìƒ ì™„ë£Œì¼**: 2025-03-07